{% if pesanan_list %}
<div class="overflow-x-auto max-h-96 overflow-y-auto border border-gray-200 rounded-lg">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50 sticky top-0 z-10">
            <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bil</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tarikh</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Package</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Qty</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Baki</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Resit</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tindakan</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for row in pesanan_list %}
            <tr class="hover:bg-gray-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ row['bil_no'] }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ row['nama'] }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ row['tarikh'] }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ row['package'] }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ row['qty'] }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">RM {{ row['total_price']|round(2) }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-bold {% if row['balance'] > 0 %}text-red-600{% else %}text-green-600{% endif %}">
                    RM {{ row['balance']|round(2) }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    <span class="px-3 py-1 rounded-full text-xs font-medium {% if row['balance'] > 0 %}bg-red-100 text-red-800{% else %}bg-green-100 text-green-600{% endif %}">
                        {{ 'Pending' if row['balance'] > 0 else 'Done' }}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    {% if row['resit_path'] %}
                    <a href="{{ url_for('view_resit', filename=row['resit_path']) }}" target="_blank" class="text-pink-600 hover:underline font-medium">
                        View Resit
                    </a>
                    {% else %}
                    <span class="text-gray-400">Tiada Resit</span>
                    {% endif %}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    {% if row['balance'] > 0 %}
                    <form method="POST" action="{{ url_for('mark_done', bil_no=row['bil_no']) }}" style="display:inline;">
                        <button type="submit" class="text-xs bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 transition">
                            Mark as Done
                        </button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<p class="text-center text-gray-500 py-8">Belum ada pesanan lagi.</p>
{% endif %}